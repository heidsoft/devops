#虚拟化#

##全虚拟化##

    简介：主要是在客户操作系统和硬件之间捕捉和处理那些对虚拟化敏感的特权指令，使客户操作系统无需修改就能运行，速度会根据不同的实现而不同，但大致能满足用户的需求。这种方式是业界现今最成熟和最常见的，而且属于 Hosted 模式和 Hypervisor 模式的都有，知名的产品有IBM CP/CMS，VirtualBox，KVM，VMware Workstation和VMware ESX（它在其4.0版，被改名为VMware vSphere）。
    优点：Guest OS无需修改，速度和功能都非常不错，更重要的是使用非常简单，不论是 VMware 的产品，还是Sun（Oracle？）的 VirtualBox。
    缺点：基于Hosted模式的全虚拟产品性能方面不是特别优异，特别是I/O方面。
    未来：因为使用这种模式，不仅Guest OS免于修改，而且将通过引入硬件辅助虚拟化技术来提高其性能，我个人判断，在未来全虚拟化还是主流。

##半虚拟化##

    简介：它与完全虚拟化有一些类似，它也利用Hypervisor来实现对底层硬件的共享访问，但是由于在Hypervisor 上面运行的Guest OS已经集成与半虚拟化有关的代码，使得Guest OS能够非常好地配合Hyperivosr来实现虚拟化。通过这种方法将无需重新编译或捕获特权指令，使其性能非常接近物理机，其最经典的产品就是Xen，而且因为微软的Hyper-V所采用技术和Xen类似，所以也可以把Hyper-V归属于半虚拟化。
    优点：这种模式和全虚拟化相比，架构更精简，而且在整体速度上有一定的优势。
    缺点：需要对Guest OS进行修改，所以在用户体验方面比较麻烦。


##硬件辅助虚拟化##

    简介：Intel/AMD等硬件厂商通过对部分全虚拟化和半虚拟化使用到的软件技术进行硬件化（具体将在下文详述）来提高性能。硬件辅助虚拟化技术常用于优化全虚拟化和半虚拟化产品，而不是独创一派，最出名的例子莫过于VMware Workstation，它虽然属于全虚拟化，但是在它的6.0版本中引入了硬件辅助虚拟化技术，比如Intel的VT-x和AMD的AMD-V。现在市面上的主流全虚拟化和半虚拟化产品都支持硬件辅助虚拟化，包括VirtualBox，KVM，VMware ESX和Xen。
    优点：通过引入硬件技术，将使虚拟化技术更接近物理机的速度。
    缺点：现有的硬件实现不够优化，还有进一步提高的空间。


##KVM
###kvm-kmod Quickstart

    1、检测CPU是否支持硬件辅助虚拟化
    egrep '^flags.*(vmx|svm)' /proc/cpuinfo
    
    2、 编译  
    ./configure
    make
    make install
    
    
    Build Details
    -------------
    
    Building the KVM kernel module is performed differently depending on whether
    you are working from a clone of the git repository or from a source release.
    Notice that two kernels are involved: One from which the KVM sources
    are taken (kernel A), and one for which the module is built (kernel B).
    In almost all cases, kernel A is more recent than kernel B.
    
    - To build from a release (this is the default case), simply
    use ./configure (possibly with any arguments that are required for
    your setup, see ./configure --help) and make. The kernel specified
    with --kerneldir refers to kernel B, that is, the kernel for which
    the module is built. All sources required from kernel A are already
    included in the release.
    
    - Building from a cloned git repository (most likely useful for developers
    only) requires a kernel tree with the main kvm sources (kernel A) that
    is included as a submodule in the linux/ directory.  By default, the KVM
    development tree on git.kernel.org is used, but this can be changed in
    the git configuration after the 'submodule init' step.
    
    Before the kvm module can be built, the linux submodule must be initialised
    and populated. The required sequence of commands is
    
    git submodule init
    git submodule update
    ./configure
    make sync
    make
    
